nohup: 忽略输入
 --------------  打印所有的参数 ----------------
Namespace(agg='concat', batch_size=8192, dataset='music', dim=128, eval_batch_size=4096, item_triple_set_size=16, kg_loss_weight=0.01, l2_weight=0.0001, lr=0.0035, n_epoch=50, n_layer=3, random_flag=False, random_seed=42, show_topk=True, temperature=15, use_contrastive_loss=True, use_cross=True, use_cuda=True, use_kg_loss=True, use_knowledge_gate=True, user_triple_set_size=32)
 ---------------------------------------------
[2023-09-16 21:05:21,568] INFO: ================== preparing data ===================
[2023-09-16 21:05:21,568] INFO: load rating file: ../data/music/ratings_final.npy
[2023-09-16 21:05:21,582] INFO: splitting dataset to 6:2:2 ...
[2023-09-16 21:05:21,590] INFO: contructing users' initial entity set ...
[2023-09-16 21:05:21,624] INFO: contructing items' initial entity set ...
[2023-09-16 21:05:21,676] INFO: loading kg file: ../data/music/kg_final.npy
[2023-09-16 21:05:21,679] INFO: constructing knowledge graph ...
[2023-09-16 21:05:21,689] INFO: contructing users' kg triple sets ...
[2023-09-16 21:05:21,747] INFO: contructing items' kg triple sets ...
n_user:  1872 n_item:  3846 n_entity:  9366 n_relation:  60
[2023-09-16 21:05:21,933] INFO: ================== training CKAN ====================
use cuda!
[2023-09-16 21:05:25,405] INFO: epoch 00    eval auc: 0.7615 f1: 0.6984    test auc: 0.7593 f1: 0.7153
[2023-09-16 21:06:37,361] INFO: K@5:0.0137  K@10:0.0245  K@20:0.0728  K@50:0.1370  K@100:0.2198  
[2023-09-16 21:06:39,381] INFO: epoch 01    eval auc: 0.7762 f1: 0.7175    test auc: 0.7799 f1: 0.7377
[2023-09-16 21:07:51,405] INFO: K@5:0.0317  K@10:0.0503  K@20:0.0628  K@50:0.1365  K@100:0.2130  
[2023-09-16 21:07:53,409] INFO: epoch 02    eval auc: 0.7737 f1: 0.7205    test auc: 0.7805 f1: 0.7420
[2023-09-16 21:09:05,861] INFO: K@5:0.0477  K@10:0.0760  K@20:0.1142  K@50:0.1772  K@100:0.2817  
[2023-09-16 21:09:07,874] INFO: epoch 03    eval auc: 0.7705 f1: 0.7184    test auc: 0.7793 f1: 0.7437
[2023-09-16 21:10:19,778] INFO: K@5:0.0412  K@10:0.0545  K@20:0.1023  K@50:0.1560  K@100:0.2558  
[2023-09-16 21:10:21,797] INFO: epoch 04    eval auc: 0.7630 f1: 0.7179    test auc: 0.7744 f1: 0.7411
[2023-09-16 21:11:33,652] INFO: K@5:0.0475  K@10:0.0592  K@20:0.0962  K@50:0.1448  K@100:0.2472  
[2023-09-16 21:11:35,666] INFO: epoch 05    eval auc: 0.7557 f1: 0.7111    test auc: 0.7706 f1: 0.7396
[2023-09-16 21:12:47,564] INFO: K@5:0.0014  K@10:0.0239  K@20:0.0339  K@50:0.0784  K@100:0.1637  
[2023-09-16 21:12:49,585] INFO: epoch 06    eval auc: 0.7693 f1: 0.7193    test auc: 0.7839 f1: 0.7447
[2023-09-16 21:14:01,543] INFO: K@5:0.0317  K@10:0.0600  K@20:0.0900  K@50:0.1317  K@100:0.2093  
[2023-09-16 21:14:03,563] INFO: epoch 07    eval auc: 0.7930 f1: 0.7355    test auc: 0.8061 f1: 0.7584
[2023-09-16 21:15:15,493] INFO: K@5:0.0483  K@10:0.0675  K@20:0.0892  K@50:0.2073  K@100:0.2639  
[2023-09-16 21:15:17,518] INFO: epoch 08    eval auc: 0.8111 f1: 0.7338    test auc: 0.8257 f1: 0.7582
[2023-09-16 21:16:29,466] INFO: K@5:0.0443  K@10:0.0785  K@20:0.1217  K@50:0.1963  K@100:0.2808  
[2023-09-16 21:16:31,495] INFO: epoch 09    eval auc: 0.8208 f1: 0.7214    test auc: 0.8375 f1: 0.7369
[2023-09-16 21:17:43,403] INFO: K@5:0.0475  K@10:0.0762  K@20:0.1102  K@50:0.2265  K@100:0.3233  
[2023-09-16 21:17:45,426] INFO: epoch 10    eval auc: 0.8310 f1: 0.7168    test auc: 0.8476 f1: 0.7372
[2023-09-16 21:18:57,210] INFO: K@5:0.0483  K@10:0.0787  K@20:0.1295  K@50:0.2183  K@100:0.3289  
[2023-09-16 21:18:59,237] INFO: epoch 11    eval auc: 0.8454 f1: 0.7342    test auc: 0.8587 f1: 0.7545
[2023-09-16 21:20:11,097] INFO: K@5:0.0512  K@10:0.0828  K@20:0.1312  K@50:0.2552  K@100:0.3510  
[2023-09-16 21:20:13,126] INFO: epoch 12    eval auc: 0.8575 f1: 0.7605    test auc: 0.8677 f1: 0.7730
[2023-09-16 21:21:25,035] INFO: K@5:0.1112  K@10:0.1412  K@20:0.1818  K@50:0.3034  K@100:0.4186  
[2023-09-16 21:21:27,064] INFO: epoch 13    eval auc: 0.8658 f1: 0.7734    test auc: 0.8733 f1: 0.7796
[2023-09-16 21:22:38,985] INFO: K@5:0.0853  K@10:0.1210  K@20:0.2415  K@50:0.3480  K@100:0.4572  
[2023-09-16 21:22:41,020] INFO: epoch 14    eval auc: 0.8698 f1: 0.7749    test auc: 0.8752 f1: 0.7744
[2023-09-16 21:23:52,937] INFO: K@5:0.0888  K@10:0.1372  K@20:0.1748  K@50:0.3174  K@100:0.4452  
[2023-09-16 21:23:54,974] INFO: epoch 15    eval auc: 0.8729 f1: 0.7791    test auc: 0.8764 f1: 0.7813
[2023-09-16 21:25:06,820] INFO: K@5:0.0392  K@10:0.0900  K@20:0.1496  K@50:0.3056  K@100:0.4115  
[2023-09-16 21:25:08,849] INFO: epoch 16    eval auc: 0.8746 f1: 0.7796    test auc: 0.8776 f1: 0.7875
[2023-09-16 21:26:20,723] INFO: K@5:0.0729  K@10:0.1038  K@20:0.1588  K@50:0.2721  K@100:0.4880  
[2023-09-16 21:26:22,755] INFO: epoch 17    eval auc: 0.8758 f1: 0.7882    test auc: 0.8778 f1: 0.7885
[2023-09-16 21:27:34,486] INFO: K@5:0.0615  K@10:0.1050  K@20:0.1745  K@50:0.3228  K@100:0.4315  
[2023-09-16 21:27:36,517] INFO: epoch 18    eval auc: 0.8760 f1: 0.7875    test auc: 0.8771 f1: 0.7823
[2023-09-16 21:28:48,365] INFO: K@5:0.0652  K@10:0.1314  K@20:0.2034  K@50:0.3477  K@100:0.5227  
[2023-09-16 21:28:50,396] INFO: epoch 19    eval auc: 0.8760 f1: 0.7854    test auc: 0.8766 f1: 0.7807
[2023-09-16 21:30:02,238] INFO: K@5:0.0682  K@10:0.1197  K@20:0.2020  K@50:0.3685  K@100:0.4438  
[2023-09-16 21:30:04,274] INFO: epoch 20    eval auc: 0.8759 f1: 0.7889    test auc: 0.8757 f1: 0.7773
[2023-09-16 21:31:16,156] INFO: K@5:0.0707  K@10:0.1054  K@20:0.1460  K@50:0.2715  K@100:0.3987  
[2023-09-16 21:31:18,188] INFO: epoch 21    eval auc: 0.8748 f1: 0.7886    test auc: 0.8745 f1: 0.7815
[2023-09-16 21:32:30,163] INFO: K@5:0.0875  K@10:0.1323  K@20:0.1817  K@50:0.3433  K@100:0.4879  
[2023-09-16 21:32:32,193] INFO: epoch 22    eval auc: 0.8743 f1: 0.7841    test auc: 0.8728 f1: 0.7743
[2023-09-16 21:33:44,061] INFO: K@5:0.0658  K@10:0.1000  K@20:0.1475  K@50:0.2660  K@100:0.3935  
[2023-09-16 21:33:46,090] INFO: epoch 23    eval auc: 0.8733 f1: 0.7810    test auc: 0.8713 f1: 0.7727
[2023-09-16 21:34:58,003] INFO: K@5:0.0822  K@10:0.1150  K@20:0.1831  K@50:0.3444  K@100:0.4375  
[2023-09-16 21:35:00,033] INFO: epoch 24    eval auc: 0.8716 f1: 0.7851    test auc: 0.8699 f1: 0.7785
[2023-09-16 21:36:12,012] INFO: K@5:0.0836  K@10:0.1091  K@20:0.1515  K@50:0.3315  K@100:0.4199  
[2023-09-16 21:36:14,045] INFO: epoch 25    eval auc: 0.8705 f1: 0.7863    test auc: 0.8691 f1: 0.7835
[2023-09-16 21:37:25,818] INFO: K@5:0.0863  K@10:0.1208  K@20:0.1815  K@50:0.3079  K@100:0.4512  
[2023-09-16 21:37:27,845] INFO: epoch 26    eval auc: 0.8695 f1: 0.7824    test auc: 0.8684 f1: 0.7869
[2023-09-16 21:38:39,660] INFO: K@5:0.0922  K@10:0.1188  K@20:0.1615  K@50:0.2961  K@100:0.4119  
[2023-09-16 21:38:41,695] INFO: epoch 27    eval auc: 0.8689 f1: 0.7829    test auc: 0.8678 f1: 0.7841
[2023-09-16 21:39:53,685] INFO: K@5:0.0525  K@10:0.0983  K@20:0.1285  K@50:0.2581  K@100:0.3714  
[2023-09-16 21:39:55,718] INFO: epoch 28    eval auc: 0.8679 f1: 0.7796    test auc: 0.8674 f1: 0.7828
[2023-09-16 21:41:07,604] INFO: K@5:0.0627  K@10:0.1043  K@20:0.1662  K@50:0.2793  K@100:0.4332  
[2023-09-16 21:41:09,637] INFO: epoch 29    eval auc: 0.8671 f1: 0.7796    test auc: 0.8661 f1: 0.7825
[2023-09-16 21:42:21,416] INFO: K@5:0.1148  K@10:0.1393  K@20:0.2355  K@50:0.3200  K@100:0.4757  
[2023-09-16 21:42:23,450] INFO: epoch 30    eval auc: 0.8664 f1: 0.7772    test auc: 0.8637 f1: 0.7804
[2023-09-16 21:43:35,348] INFO: K@5:0.0725  K@10:0.1113  K@20:0.1695  K@50:0.2833  K@100:0.4232  
[2023-09-16 21:43:37,381] INFO: epoch 31    eval auc: 0.8652 f1: 0.7772    test auc: 0.8613 f1: 0.7795
[2023-09-16 21:44:49,352] INFO: K@5:0.0839  K@10:0.1105  K@20:0.1768  K@50:0.3227  K@100:0.4743  
[2023-09-16 21:44:51,385] INFO: epoch 32    eval auc: 0.8646 f1: 0.7772    test auc: 0.8603 f1: 0.7759
[2023-09-16 21:46:03,194] INFO: K@5:0.0863  K@10:0.1167  K@20:0.1853  K@50:0.3357  K@100:0.4083  
[2023-09-16 21:46:05,221] INFO: epoch 33    eval auc: 0.8642 f1: 0.7809    test auc: 0.8607 f1: 0.7747
[2023-09-16 21:47:17,049] INFO: K@5:0.0708  K@10:0.1423  K@20:0.1697  K@50:0.3183  K@100:0.4360  
[2023-09-16 21:47:19,079] INFO: epoch 34    eval auc: 0.8635 f1: 0.7809    test auc: 0.8594 f1: 0.7782
[2023-09-16 21:48:31,007] INFO: K@5:0.0695  K@10:0.1212  K@20:0.1987  K@50:0.3303  K@100:0.4495  
[2023-09-16 21:48:33,036] INFO: epoch 35    eval auc: 0.8631 f1: 0.7828    test auc: 0.8583 f1: 0.7752
[2023-09-16 21:49:44,956] INFO: K@5:0.0578  K@10:0.0943  K@20:0.1344  K@50:0.2269  K@100:0.3379  
[2023-09-16 21:49:46,990] INFO: epoch 36    eval auc: 0.8612 f1: 0.7792    test auc: 0.8568 f1: 0.7745
[2023-09-16 21:50:58,891] INFO: K@5:0.0766  K@10:0.1105  K@20:0.1542  K@50:0.2590  K@100:0.3673  
[2023-09-16 21:51:00,925] INFO: epoch 37    eval auc: 0.8589 f1: 0.7790    test auc: 0.8552 f1: 0.7704
[2023-09-16 21:52:12,704] INFO: K@5:0.0673  K@10:0.1060  K@20:0.1928  K@50:0.3197  K@100:0.4068  
[2023-09-16 21:52:14,735] INFO: epoch 38    eval auc: 0.8568 f1: 0.7824    test auc: 0.8542 f1: 0.7698
[2023-09-16 21:53:26,600] INFO: K@5:0.0520  K@10:0.0948  K@20:0.1609  K@50:0.2762  K@100:0.3958  
[2023-09-16 21:53:28,638] INFO: epoch 39    eval auc: 0.8555 f1: 0.7800    test auc: 0.8530 f1: 0.7689
[2023-09-16 21:54:40,527] INFO: K@5:0.0672  K@10:0.1247  K@20:0.1833  K@50:0.3487  K@100:0.4463  
[2023-09-16 21:54:42,557] INFO: epoch 40    eval auc: 0.8545 f1: 0.7793    test auc: 0.8510 f1: 0.7689
[2023-09-16 21:55:54,495] INFO: K@5:0.0765  K@10:0.1063  K@20:0.1645  K@50:0.2870  K@100:0.3703  
[2023-09-16 21:55:56,521] INFO: epoch 41    eval auc: 0.8541 f1: 0.7841    test auc: 0.8499 f1: 0.7687
[2023-09-16 21:57:08,344] INFO: K@5:0.0723  K@10:0.1205  K@20:0.1708  K@50:0.3172  K@100:0.4170  
[2023-09-16 21:57:10,375] INFO: epoch 42    eval auc: 0.8534 f1: 0.7837    test auc: 0.8495 f1: 0.7655
[2023-09-16 21:58:22,193] INFO: K@5:0.1222  K@10:0.1958  K@20:0.2445  K@50:0.3683  K@100:0.4753  
[2023-09-16 21:58:24,225] INFO: epoch 43    eval auc: 0.8528 f1: 0.7841    test auc: 0.8494 f1: 0.7661
[2023-09-16 21:59:36,087] INFO: K@5:0.0533  K@10:0.1148  K@20:0.1475  K@50:0.3088  K@100:0.3774  
[2023-09-16 21:59:38,121] INFO: epoch 44    eval auc: 0.8515 f1: 0.7800    test auc: 0.8485 f1: 0.7675
[2023-09-16 22:00:49,880] INFO: K@5:0.0537  K@10:0.1268  K@20:0.1842  K@50:0.3192  K@100:0.4210  
[2023-09-16 22:00:51,918] INFO: epoch 45    eval auc: 0.8505 f1: 0.7824    test auc: 0.8479 f1: 0.7690
[2023-09-16 22:02:03,828] INFO: K@5:0.0697  K@10:0.1342  K@20:0.2207  K@50:0.3335  K@100:0.4077  
[2023-09-16 22:02:05,861] INFO: epoch 46    eval auc: 0.8505 f1: 0.7796    test auc: 0.8472 f1: 0.7631
[2023-09-16 22:03:17,838] INFO: K@5:0.0242  K@10:0.0942  K@20:0.1725  K@50:0.2770  K@100:0.3726  
[2023-09-16 22:03:19,870] INFO: epoch 47    eval auc: 0.8500 f1: 0.7809    test auc: 0.8468 f1: 0.7631
[2023-09-16 22:04:31,658] INFO: K@5:0.0715  K@10:0.1129  K@20:0.1683  K@50:0.2930  K@100:0.4004  
[2023-09-16 22:04:33,693] INFO: epoch 48    eval auc: 0.8488 f1: 0.7800    test auc: 0.8456 f1: 0.7644
[2023-09-16 22:05:45,448] INFO: K@5:0.0581  K@10:0.0949  K@20:0.1454  K@50:0.2811  K@100:0.4135  
[2023-09-16 22:05:47,481] INFO: epoch 49    eval auc: 0.8479 f1: 0.7799    test auc: 0.8447 f1: 0.7663
[2023-09-16 22:06:59,285] INFO: K@5:0.0740  K@10:0.1102  K@20:0.2014  K@50:0.3222  K@100:0.4268  
