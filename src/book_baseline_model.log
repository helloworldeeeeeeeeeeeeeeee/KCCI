nohup: 忽略输入
 --------------  打印所有的参数 ----------------
Namespace(agg='concat', batch_size=8192, contrastive_loss_weight=0.01, dataset='book', dim=32, eval_batch_size=4096, item_triple_set_size=32, kg_loss_weight=0.01, l2_weight=0.0001, lr=0.0035, n_epoch=50, n_layer=3, random_flag=False, random_seed=42, show_topk=True, temperature=15, use_contrastive_loss=True, use_cross=True, use_cuda=True, use_kg_loss=True, use_knowledge_gate=True, user_triple_set_size=32)
 ---------------------------------------------
[2023-09-17 13:53:52,318] INFO: ================== preparing data ===================
[2023-09-17 13:53:52,318] INFO: load rating file: ../data/book/ratings_final.npy
[2023-09-17 13:53:52,333] INFO: splitting dataset to 6:2:2 ...
[2023-09-17 13:53:52,356] INFO: contructing users' initial entity set ...
[2023-09-17 13:53:52,475] INFO: contructing items' initial entity set ...
[2023-09-17 13:53:52,766] INFO: loading kg file: ../data/book/kg_final.npy
[2023-09-17 13:53:52,792] INFO: constructing knowledge graph ...
[2023-09-17 13:53:52,955] INFO: contructing users' kg triple sets ...
[2023-09-17 13:53:54,687] INFO: contructing items' kg triple sets ...
n_user:  17860 n_item:  14967 n_entity:  77903 n_relation:  25
[2023-09-17 13:53:58,857] INFO: ================== training CKAN ====================
use cuda!
[2023-09-17 13:54:06,562] INFO: epoch 00    eval auc: 0.6461 f1: 0.6332    test auc: 0.6439 f1: 0.6344
[2023-09-17 13:59:34,405] INFO: K@5:0.0100  K@10:0.0100  K@20:0.0125  K@50:0.0275  K@100:0.0331  
[2023-09-17 13:59:40,741] INFO: epoch 01    eval auc: 0.6482 f1: 0.6331    test auc: 0.6441 f1: 0.6345
[2023-09-17 14:05:08,690] INFO: K@5:0.0200  K@10:0.0200  K@20:0.0200  K@50:0.0200  K@100:0.0433  
[2023-09-17 14:05:15,022] INFO: epoch 02    eval auc: 0.6498 f1: 0.6388    test auc: 0.6469 f1: 0.6396
[2023-09-17 14:10:43,107] INFO: K@5:0.0004  K@10:0.0004  K@20:0.0004  K@50:0.0004  K@100:0.0329  
[2023-09-17 14:10:49,463] INFO: epoch 03    eval auc: 0.6523 f1: 0.6328    test auc: 0.6508 f1: 0.6388
[2023-09-17 14:16:17,644] INFO: K@5:0.0000  K@10:0.0025  K@20:0.0125  K@50:0.0175  K@100:0.0325  
[2023-09-17 14:16:24,001] INFO: epoch 04    eval auc: 0.6651 f1: 0.6239    test auc: 0.6645 f1: 0.6294
[2023-09-17 14:21:52,205] INFO: K@5:0.0000  K@10:0.0013  K@20:0.0112  K@50:0.0152  K@100:0.0252  
[2023-09-17 14:21:58,568] INFO: epoch 05    eval auc: 0.6772 f1: 0.5938    test auc: 0.6774 f1: 0.5962
[2023-09-17 14:27:26,423] INFO: K@5:0.0000  K@10:0.0000  K@20:0.0000  K@50:0.0000  K@100:0.0110  
[2023-09-17 14:27:32,794] INFO: epoch 06    eval auc: 0.6926 f1: 0.5945    test auc: 0.6942 f1: 0.5968
[2023-09-17 14:33:01,210] INFO: K@5:0.0000  K@10:0.0100  K@20:0.0100  K@50:0.0211  K@100:0.0467  
[2023-09-17 14:33:07,573] INFO: epoch 07    eval auc: 0.7279 f1: 0.6155    test auc: 0.7324 f1: 0.6201
[2023-09-17 14:38:35,396] INFO: K@5:0.0150  K@10:0.0350  K@20:0.0450  K@50:0.0581  K@100:0.0728  
[2023-09-17 14:38:41,759] INFO: epoch 08    eval auc: 0.7649 f1: 0.6501    test auc: 0.7715 f1: 0.6581
[2023-09-17 14:44:09,568] INFO: K@5:0.0370  K@10:0.0518  K@20:0.0587  K@50:0.0965  K@100:0.1474  
[2023-09-17 14:44:15,950] INFO: epoch 09    eval auc: 0.7736 f1: 0.6651    test auc: 0.7803 f1: 0.6692
[2023-09-17 14:49:43,135] INFO: K@5:0.0051  K@10:0.0117  K@20:0.0352  K@50:0.0965  K@100:0.1371  
[2023-09-17 14:49:49,486] INFO: epoch 10    eval auc: 0.7743 f1: 0.6678    test auc: 0.7803 f1: 0.6717
[2023-09-17 14:55:17,236] INFO: K@5:0.0088  K@10:0.0089  K@20:0.0118  K@50:0.0732  K@100:0.1072  
[2023-09-17 14:55:23,594] INFO: epoch 11    eval auc: 0.7767 f1: 0.6699    test auc: 0.7823 f1: 0.6735
[2023-09-17 15:00:51,348] INFO: K@5:0.0024  K@10:0.0303  K@20:0.0710  K@50:0.1429  K@100:0.1715  
[2023-09-17 15:00:57,701] INFO: epoch 12    eval auc: 0.7781 f1: 0.6705    test auc: 0.7835 f1: 0.6759
[2023-09-17 15:06:25,482] INFO: K@5:0.0168  K@10:0.0293  K@20:0.0583  K@50:0.1107  K@100:0.1878  
[2023-09-17 15:06:31,859] INFO: epoch 13    eval auc: 0.7783 f1: 0.6748    test auc: 0.7836 f1: 0.6777
[2023-09-17 15:11:59,467] INFO: K@5:0.0142  K@10:0.0243  K@20:0.0493  K@50:0.0872  K@100:0.1663  
[2023-09-17 15:12:05,838] INFO: epoch 14    eval auc: 0.7787 f1: 0.6746    test auc: 0.7838 f1: 0.6785
[2023-09-17 15:17:33,483] INFO: K@5:0.0138  K@10:0.0138  K@20:0.0205  K@50:0.0447  K@100:0.1001  
[2023-09-17 15:17:39,864] INFO: epoch 15    eval auc: 0.7786 f1: 0.6767    test auc: 0.7835 f1: 0.6802
[2023-09-17 15:23:07,574] INFO: K@5:0.0142  K@10:0.0308  K@20:0.0465  K@50:0.0920  K@100:0.1174  
[2023-09-17 15:23:13,944] INFO: epoch 16    eval auc: 0.7785 f1: 0.6728    test auc: 0.7832 f1: 0.6783
[2023-09-17 15:28:41,944] INFO: K@5:0.0120  K@10:0.0186  K@20:0.0405  K@50:0.0755  K@100:0.1148  
[2023-09-17 15:28:48,302] INFO: epoch 17    eval auc: 0.7780 f1: 0.6744    test auc: 0.7832 f1: 0.6796
[2023-09-17 15:34:15,796] INFO: K@5:0.0100  K@10:0.0261  K@20:0.0400  K@50:0.0593  K@100:0.1198  
[2023-09-17 15:34:22,162] INFO: epoch 18    eval auc: 0.7765 f1: 0.6740    test auc: 0.7816 f1: 0.6789
[2023-09-17 15:39:50,515] INFO: K@5:0.0033  K@10:0.0237  K@20:0.0446  K@50:0.0627  K@100:0.1025  
[2023-09-17 15:39:56,883] INFO: epoch 19    eval auc: 0.7764 f1: 0.6765    test auc: 0.7810 f1: 0.6803
[2023-09-17 15:45:24,882] INFO: K@5:0.0122  K@10:0.0123  K@20:0.0407  K@50:0.0582  K@100:0.1247  
[2023-09-17 15:45:31,255] INFO: epoch 20    eval auc: 0.7753 f1: 0.6725    test auc: 0.7799 f1: 0.6783
[2023-09-17 15:50:59,141] INFO: K@5:0.0035  K@10:0.0392  K@20:0.0467  K@50:0.1018  K@100:0.1283  
[2023-09-17 15:51:05,551] INFO: epoch 21    eval auc: 0.7738 f1: 0.6741    test auc: 0.7780 f1: 0.6765
[2023-09-17 15:59:14,429] INFO: K@5:0.0067  K@10:0.0107  K@20:0.0330  K@50:0.0463  K@100:0.0737  
[2023-09-17 15:59:20,789] INFO: epoch 22    eval auc: 0.7724 f1: 0.6711    test auc: 0.7765 f1: 0.6754
Terminated
